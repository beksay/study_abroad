<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
    <title>Регистрация инспектора</title>
    <style type="text/css">
        .col1 {
            width: 600px;
        }

        .col2 {
        }
    </style>
</h:head>

<h:body>

    <p:panel id="rootPanel" header="Подача заявления">
        <p:messages>
            <p:autoUpdate/>
        </p:messages>
        
        <h:form id="form1">
            <p:panel id="panel1" header="РАЗДЕЛ I. ИНФОРМАЦИЯ ИНСПЕКТОРА">
                <p:panelGrid id="grid1" columns="3">
                    <p:outputLabel for="inn" value="#{msgs.inn}"/>
                    <p:autoComplete id="inn" size="27" dropdown="true" converter="legalPersonConverter" 
				    	var="c" itemValue="#{c}" itemLabel="#{c.fullName ne null ? (c.inn.concat(' - ').concat(c.fullName)) : ''}" 
						value="#{registrationBean.legalPerson}" completeMethod="#{registrationBean.findLegalPerson}" 
						minQueryLength="3" required="true"	requiredMessage="#{msgs.thisFieldIsRequired}">
						<p:column><h:outputText value="#{c.inn}"/></p:column>
			            <p:ajax event="itemSelect" update="fio"/>
					</p:autoComplete>
					<p:message for="inn"/>
                    
                    <p:outputLabel for="fio" value="#{msgs.fio}"/>
                    <p:outputLabel id="fio" value="#{registrationBean.legalPerson.fullName}"/>
					<p:message for="fio"/>
					
					<p:outputLabel for="stiOrganization" value="#{msgs.stiOrganization}"/>
                    <p:autoComplete id="stiOrganization" dropdown="true" converter="dictionaryConverter" size="27" 
				    	var="c" itemValue="#{c}" itemLabel="#{c.name ne null ? (c.code.concat(' - ').concat(c.name)) : ''}" 
						value="#{registrationBean.entity.stiOrganization}" completeMethod="#{registrationBean.findStiOrganazation}" 
						required="true" requiredMessage="#{msgs.thisFieldIsRequired}">
						<p:column><h:outputText value="#{c.code}"/></p:column>
			            <p:column><h:outputText value="#{c.name}"/></p:column>
					</p:autoComplete>
					<p:message for="stiOrganization"/>
					
					<p:outputLabel for="stiDepartment" value="Управление/Отдел"/>
                    <p:autoComplete id="stiDepartment" dropdown="true" converter="dictionaryConverter" size="27" 
				    	var="c" itemValue="#{c}" itemLabel="#{c.name}" 
						value="#{registrationBean.entity.department}" completeMethod="#{registrationBean.findStiDepartment}" 
						required="true"	requiredMessage="#{msgs.thisFieldIsRequired}">
						<p:column><h:outputText value="#{c.name}"/></p:column>
					</p:autoComplete>
					<p:message for="stiDepartment"/>
										
					<p:outputLabel for="position" value="#{msgs.position}"/>
                    <p:autoComplete id="position" dropdown="true" converter="dictionaryConverter" size="27" 
				    	var="c" itemValue="#{c}" itemLabel="#{c.name}" 
						value="#{registrationBean.entity.position}" completeMethod="#{registrationBean.findStiPosition}" 
						required="true"	requiredMessage="#{msgs.thisFieldIsRequired}">
						<p:column><h:outputText value="#{c.name}"/></p:column>
					</p:autoComplete>
					<p:message for="position"/>
					
                    <p:outputLabel for="number" value="Номер удостоверения"/>
                    <p:inputText id="number" value="#{registrationBean.entity.signerPassportNumber}" required="true" requiredMessage="#{msgs.thisFieldIsRequired}" />
					<p:message for="number"/>
					
                    <p:outputLabel for="email" value="#{msgs.email}"/>
                    <p:inputText id="email" value="#{registrationBean.entity.email}" required="true" requiredMessage="#{msgs.thisFieldIsRequired}"/>
                    <p:message for="email"/>
                    
                    <p:outputLabel for="username" value="#{msgs.username}"/>
                    <p:inputText id="username" value="#{registrationBean.entity.userName}" required="true" requiredMessage="#{msgs.thisFieldIsRequired}"/>
                    <p:message for="username"/>
                    
                    <h:outputLabel for="pwd1" value="#{msgs.password}" />
			        <p:password id="pwd1" value="#{registrationBean.entity.password}" match="pwd2" label="Password 1" required="true" requiredMessage="#{msgs.thisFieldIsRequired}"/>
			        <p:message for="pwd1"/>
			 
			        <h:outputLabel for="pwd2" value="#{msgs.confirmPassword}" />
			        <p:password id="pwd2" value="#{registrationBean.entity.password}" label="Password 2" required="true" requiredMessage="#{msgs.thisFieldIsRequired}"/>
			        <p:message for="pwd2"/>
                </p:panelGrid>
                
                <f:facet name="footer">
                    <p:commandButton id="signAndSend" value="Отправить" action="#{registrationBean.registerInspector()}"/>
                    <p:button id="cancel" value="Отмена" outcome="login"/>
                </f:facet>
            </p:panel>

        </h:form>

    </p:panel>

</h:body>

</html>