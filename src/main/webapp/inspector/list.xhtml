<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/layouts/private.xhtml">

    <f:metadata>
        <f:importConstants type="org.infosystema.iselect.enums.AuthType" var="authType"/>
    </f:metadata>
    <ui:define name="content">
	    <p:messages>
	        <p:autoUpdate/>
	    </p:messages>
	    
	    <h:form id ="filter-form">
		  <h:panelGroup>
			    <h:panelGrid columns="1">
				    <h:outputText value="#{msgs.searchString}" />
					<p:inputText value="#{inspectorList.searchString}"/>
	            </h:panelGrid>
	            
		        <h:panelGrid columns="1">
				    <h:outputText value="#{msgs.confirmed}"/>
					<p:selectOneMenu value="#{inspectorList.confirmed}" style="width:125px">
			            <f:selectItem itemLabel="#{msgs.all}" itemValue="#{null}"/>
			            <f:selectItem itemLabel="#{msgs.yes}" itemValue="#{true}"/>
			            <f:selectItem itemLabel="#{msgs.no}" itemValue="#{false}"/>
			        </p:selectOneMenu>
        		</h:panelGrid>
        		
	            <div class="com-buttons">
	              <p:commandButton ajax="true" update="form" value="#{msgs.search}" actionListener="#{inspectorList.filterData()}" styleClass="button default" />
				  <p:commandButton ajax="true" update="form filter-form" value="#{msgs.clearFilter}" actionListener="#{inspectorList.clearFilter()}" styleClass="button blue " />	
	            </div>
	            
		   </h:panelGroup>		 		    
		</h:form>
	    
	    <h:form id="form">
	        <p:dataTable id="dt1" value="#{inspectorList.model}" var="reg" emptyMessage="#{msgs.noRecordsFound}" 
	        			 paginator="true" rows="20" lazy="true" sortOrder="DESCENDING"
	                     rowKey="#{entity.id}" rowIndexVar="index" tableStyleClass="display-table"
	                     rowsPerPageTemplate="10,20,30,40,50" paginatorPosition="bottom" pageLinks="10"
	                     currentPageReportTemplate="Всего : #{inspectorList.model.rowCount} из #{inspectorList.model.totalCount}  &#160;&#160;| #{msgs.amountPerPage}"
	                     paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {CurrentPageReport} {RowsPerPageDropdown}"
	                     first="#{inspectorList.first}">
	                         
	            <p:column headerText="#{msgs.inn}">
	                <h:outputText value="#{reg.companyInn}"/>
	            </p:column>
	            
	            <p:column headerText="Наименование" rendered="#{userController.contain(3)}">
	                <h:outputText value="#{reg.companyName}"/>
	            </p:column>
	
	            <p:column headerText="#{msgs.fio}">
	                <h:outputText value="#{reg.signerName}"/>
	            </p:column>
	            
	            <p:column headerText="#{msgs.stiOrganization}" rendered="#{userController.contain(0)}">
	                <h:outputText value="#{reg.stiOrganization.name}"/>
	            </p:column>
	            
	            <p:column headerText="Управление/Отдел" rendered="#{userController.contain(0)}">
	                <h:outputText value="#{reg.department.name}"/>
	            </p:column>
	            
	            <p:column headerText="#{msgs.position}">
	                <h:outputText value="#{reg.signerPosition}" rendered="#{userController.contain(3)}"/>
	                <h:outputText value="#{reg.stiOrganization.name}" rendered="#{userController.contain(0)}"/>
	            </p:column>
	            
	            <p:column headerText="#{userController.contain(0) ? 'Номер удостоверения' : msgs.passportNumber}">
	                <h:outputText value="#{reg.signerPassportNumber}"/>
	            </p:column>
	            
	            <p:column headerText="#{msgs.email}">
	                <h:outputText value="#{reg.email}"/>
	            </p:column>
	
	            <p:column headerText="#{msgs.username}" rendered="#{userController.contain(0)}">
	                <h:outputText value="#{reg.userName}"/>
	            </p:column>
				
				<p:column headerText="#{msgs.regType}">
	                <h:outputText value="#{reg.regType.name}"/>
	            </p:column>
				
				<p:column headerText="#{msgs.regBase}" rendered="#{userController.contain(3)}">
	                <h:outputText value="#{reg.regBase.name}"/>
	            </p:column>
	            
	            <p:column headerText="#{msgs.confirmed}">
	                <h:outputText value="#{msgs.yes}" rendered="#{reg.confirmed}"/>
	                <h:outputText value="#{msgs.no}"  rendered="#{reg.confirmed ne true}"/>
	            </p:column>
	
	            <p:column>
	                <p:commandButton value="Просмотр"/>
	                <p:commandButton value="Подтвердить" action="#{inspectorList.confirm(reg)}" update="dt1"/>
	            </p:column>
	        </p:dataTable>
	    </h:form>
	</ui:define>
</ui:composition>