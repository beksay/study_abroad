<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/layouts/base.xhtml">
    <ui:define name="content">
      <div class="form-app">
        <h2>#{msgs.documentsForm}</h2> 
		<br/><br/>	        
		 <h:form id="mainForm">
		 <h:panelGrid columns="4">    
		        <h:panelGrid columns="1">
		            <h:panelGroup>
		                <h:outputText value="#{msgs.name}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<h:inputText value="#{documentsController.documents.name}" id="name" maxlength="150" style="width:300px;"
					    required="true" requiredMessage="#{msgs.thisFieldIsRequired}" />
					<p:message for="name" />
				</h:panelGrid>
				
				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.docBy}" />
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<h:inputText value="#{documentsController.documents.description}" id="description" maxlength="150" style="width:300px;"
					    required="true" requiredMessage="#{msgs.thisFieldIsRequired}"/>
				    <p:message for="description" />
				</h:panelGrid>
				
				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.docNumber}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<h:inputText value="#{documentsController.documents.number}" id="docNumber" maxlength="150" style="width:300px;" 
					       required="true" requiredMessage="#{msgs.thisFieldIsRequired}"/>
					<p:message for="docNumber" />
				</h:panelGrid>
				
				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.issueDate}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<p:calendar value="#{documentsController.documents.issueDate}" id="issueDate"  showOn="button" pattern="dd-MM-yyyy"
					  required="true" requiredMessage="#{msgs.thisFieldIsRequired}"/> 
					<p:message for="issueDate" />
				</h:panelGrid>

		  </h:panelGrid>	
		    <div style="display: none;">
				<h:commandButton id="saveButton" value="#{msgs.save}" 
						actionListener="#{documentsController.save()}" class="button" />	
		    </div>
		</h:form>
			
		<h:panelGrid columns="2" styleClass="field-groups" columnClasses="field-group-label,field-group-content" rowClasses="field-group" style="min-width: 605px;">
			<h:outputText value="#{msgs.documents}" />
			<ui:include src="/WEB-INF/templates/upload/upload.xhtml"/>
        </h:panelGrid>		
			   	
		<h:form id="formBtn">
			<div class="m-top"> 
				<p:commandButton id="save" styleClass="add-btn" onclick="document.getElementById('mainForm:saveButton').click();PF('block').show();;" 
				     value="#{msgs.save}" icon="fa fa-save" oncomplete="PF('block').hide()" />
		    	<p:commandButton value="#{msgs.back}" action="#{documentsController.cancel()}" immediate="true" styleClass="button red m-left"/>
		   	</div>	
	    </h:form> 	
		<h:form>  			
			<p:dataTable id="detailTable" var="entity" value="#{documentsController.list}" paginator="false" rowIndexVar="index"
		      lazy="false" emptyMessage="#{msgs.noRecordsFound}" sortOrder="DESCENDING">       
		         <p:column headerText="#{msgs.number}" width="100">
		        	<h:outputText value="#{index+1}" />
		         </p:column> 
		         <p:column headerText="#{msgs.name}">
			        <h:outputText value="#{entity.name}" />
		         </p:column>
		         <p:column headerText="#{msgs.docBy}">
			        <h:outputText value="#{entity.description}" />
		         </p:column>
		         <p:column headerText="#{msgs.docNumber}">
			        <h:outputText value="#{entity.number}" />
		         </p:column>	
		          <p:column headerText="#{msgs.issueDate}">
			        <h:outputText value="#{entity.issueDate}">
			            <f:convertDateTime pattern="dd-MM-yyyy" />
					 </h:outputText>
		         </p:column>
		         <p:column headerText="#{msgs.documents}">
						<p:dataList value="#{entity.attachments}" var="car">
						   <h:outputText value="#{car.fileName}" />
						</p:dataList>
				 </p:column>
		         <p:column styleClass="formeditor">
			      	<p:commandButton immediate="true" action="#{documentsController.delete(entity)}" update="@form"  icon="fa fa-remove"  />
		         </p:column>
	         </p:dataTable>
		</h:form>
		<p:blockUI block="formBtn" widgetVar="block" >
	      #{msgs.loading}<br />
	      <p:graphicImage library="img" name="ajaxloadingbar.gif"/>
        </p:blockUI>
		<div class="clear"></div>	
		</div>
    </ui:define>
</ui:composition>