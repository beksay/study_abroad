<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/layouts/base.xhtml">
	<ui:define name="content">
	  <div class="form-app">
		<h2>#{msgs.goodsForm}</h2>
		<br />
		<br />
		<h:form id="form">
			<h:panelGrid columns="3">
				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.products}" />
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<p:autoComplete id="products" dropdown="true" var="type"
						itemValue="#{type}" itemLabel="#{type.name}" 
						value="#{goodsController.goods.products}"
						converter="productConverter" scrollHeight="300"
						completeMethod="#{goodsController.getProductInfoList}"
						required="true" requiredMessage="#{msgs.thisFieldIsRequired}">
					</p:autoComplete>
					<h:message for="products" display="icon" style="color:red;" />
				</h:panelGrid>

				<h:panelGrid columns="1">
					<h:outputText value="#{msgs.productDesc}" />
					<h:inputText value="#{goodsController.goods.description}"
						id="productDesc" maxlength="150"  />
					<p:message for="productDesc" />
				</h:panelGrid>

				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.countryBy}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<p:autoComplete id="country" dropdown="true" var="type"
						itemValue="#{type}" itemLabel="#{type.name}" 
						value="#{goodsController.goods.country}"
						converter="countryConverter" scrollHeight="300"
						completeMethod="#{goodsController.getCountryList}" required="true"
						requiredMessage="#{msgs.thisFieldIsRequired}">
						<p:ajax event="itemSelect" process="@this" update="oblastId" />
					</p:autoComplete>
					<h:message for="country" display="icon" style="color:red;" />
				</h:panelGrid>
				
				<h:panelGrid columns="1" id="oblastId">
					 <h:panelGroup rendered="#{goodsController.goods.country.id eq 3929}"> 
		                <h:outputText value="#{msgs.region}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
				    <h:selectOneMenu id="regionId"
						value="#{goodsController.goods.oblast}" rendered="#{goodsController.goods.country.id eq 3929}"
						effect="fold" editable="true" converter="cachedConverter" required="true" requiredMessage="#{msgs.thisFieldIsRequired}">
						<f:selectItem itemLabel="#{msgs.selectValue}" />
						<f:selectItems value="#{goodsController.regionList}" var="cs" itemLabel="#{cs.name}" itemValue="#{cs}" />
					</h:selectOneMenu>
					<h:message for="regionId" display="icon" style="color:red;" rendered="#{goodsController.goods.country.id eq 3929}"/>
				</h:panelGrid>

				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.weight}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<h:inputText value="#{goodsController.goods.weight}" id="weight"
						maxlength="150" required="true" requiredMessage="#{msgs.thisFieldIsRequired}"/>
					<p:message for="weight" />
				</h:panelGrid>

				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.measurementUnit}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<p:autoComplete id="measurementUnit" dropdown="true" var="type"
						itemValue="#{type}" itemLabel="#{type.name}" 
						value="#{goodsController.goods.measurementUnit}"
						converter="measurementConverter" scrollHeight="300"
						completeMethod="#{goodsController.getMeasurementUnitList}"
						required="true" requiredMessage="#{msgs.thisFieldIsRequired}">
					</p:autoComplete>
					<h:message for="measurementUnit" display="icon" style="color:red;" />
				</h:panelGrid>

				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.packages}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<h:inputText value="#{goodsController.goods.packages}"
						id="packages" maxlength="150"  required="true"
						requiredMessage="#{msgs.thisFieldIsRequired}" />
					<h:message for="packages" display="icon" style="color:red;" />
				</h:panelGrid>
				
				<h:panelGrid columns="1">
					<h:panelGroup>
		                <h:outputText value="#{msgs.packageType}"/>
		                <i class="fa fa-asterisk reqField" aria-hidden="true"></i>
	                </h:panelGroup>
					<p:autoComplete id="packageTypes" dropdown="true" var="type"
						itemValue="#{type}" itemLabel="#{type.name}" 
						value="#{goodsController.goods.packageTypes}"
						converter="cachedConverter" scrollHeight="300"
						completeMethod="#{goodsController.getPackageTypeList}"
						required="true" requiredMessage="#{msgs.thisFieldIsRequired}">
					</p:autoComplete>
					<h:message for="packageTypes" display="icon" style="color:red;" />
				</h:panelGrid>
				
				<h:panelGrid columns="1">
					<h:outputText value="#{msgs.packagesExtra}"/>
					<h:inputText value="#{goodsController.goods.packagesExtra}"
						id="packagesExtra" maxlength="150"  />
					<h:message for="packagesExtra" display="icon" style="color:red;" />
				</h:panelGrid>
				
				<h:panelGrid columns="1">
					<h:outputText value="#{msgs.packageTypesExtra}"/>
					<p:autoComplete id="packageTypesExtra" dropdown="true" var="type"
						itemValue="#{type}" itemLabel="#{type.name}" 
						value="#{goodsController.goods.packageTypesExtra}"
						converter="cachedConverter" scrollHeight="300"
						completeMethod="#{goodsController.getPackageTypeList}">
					</p:autoComplete>
					<h:message for="packageTypesExtra" display="icon" style="color:red;" />
				</h:panelGrid>
			</h:panelGrid>

			<div class="m-top">
				<p:commandButton ajax="false" styleClass="add-btn" value="#{msgs.add}" actionListener="#{goodsController.save()}" />
				<p:commandButton value="#{msgs.back}" action="#{goodsController.cancel()}" immediate="true"
					styleClass="button red m-left" />
			</div>

			<p:dataTable id="detailTable" var="entity"
				value="#{goodsController.list}" paginator="false"
				rowIndexVar="index" lazy="false"
				emptyMessage="#{msgs.noRecordsFound}" sortOrder="DESCENDING">
				<p:column headerText="#{msgs.number}" width="100">
					<h:outputText value="#{index+1}" />
				</p:column>
				<p:column headerText="#{msgs.products}">
					<h:outputText value="#{entity.products.name}" />
				</p:column>
				<p:column headerText="#{msgs.productDesc}">
					<h:outputText value="#{entity.description}" />
				</p:column>
				<p:column headerText="#{msgs.countryBy}">
					<h:outputText value="#{entity.country.name}" /><br />
					<h:outputText value="#{entity.oblast.name}" rendered="#{entity.country.id eq 3929}"/>
				</p:column>
				<p:column headerText="#{msgs.weight}">
					<h:outputText value="#{entity.weight}" />
				</p:column>
				<p:column headerText="#{msgs.measurementUnit}">
					<h:outputText value="#{entity.measurementUnit.name}" />
				</p:column>
				<p:column headerText="#{msgs.packages}">
					<h:outputText value="#{entity.packages}" /><br />
					<h:outputText value="#{entity.packagesExtra}" />
				</p:column>
				<p:column headerText="#{msgs.packageType}">
					<h:outputText value="#{entity.packageTypes.name}" /><br />
					<h:outputText value="#{entity.packageTypesExtra.name}" />
				</p:column>
				<p:column styleClass="formeditor">
					<p:commandButton immediate="true"
						action="#{goodsController.editData(entity)}" update="@form form"
						icon="fa fa-edit" />
					<p:commandButton immediate="true"
						action="#{goodsController.delete(entity)}" update="@form form"
						icon="fa fa-remove" />
				</p:column>
			</p:dataTable>

		</h:form>

		<div class="clear"></div>
		</div>
	</ui:define>
</ui:composition>